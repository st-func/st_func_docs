# st_func_addinのインストール方法(デスクトップ)

st-func_addinをデスクトップ版のExcelにインストールする方法です

## マニフェストファイルのダウンロード

ホームページから最新のマニフェストファイル[manifest.xml](https://st-func.main.jp/st-func-addin/manifest.xml)をダウンロードします。

## 共有フォルダの準備

NAS等のネットワーク上のフォルダにアドインを設置する共有フォルダを用意します。ネットワーク上の場所がない場合は、ローカルPCで適当なフォルダを作成し、フォルダのプロパティからフォルダの共有を行い、共有フォルダを作成します。

![スクリーンショット1](images/install_desktop_01.png)

## マニフェストファイルの設置

先ほどダウンロードしたマニフェストファイルを共有フォルダ上にコピーします。

![スクリーンショット2](images/install_desktop_02.png)

## Excelの設定

Excelを起動し、「ファイル」→「オプション」→「トラストセンター」→「トラストセンターの設定」を開きます。

![スクリーンショット3](images/install_desktop_03.png)

![スクリーンショット4](images/install_desktop_04.png)

![スクリーンショット5](images/install_desktop_05.png)

「信頼できるアドインカタログ」を選び、先ほど作った共有フォルダのパス（\\\\で始まるパス）を「カタログのURL」のところに入力し、「カタログの追加」をクリックします。

![スクリーンショット6](images/install_desktop_06.png)

「メニューに表示する」にチェックをつけて「OK」をクリックします。

![スクリーンショット7](images/install_desktop_07.png)

Excelでブックを開き、「ホーム」タブ→「アドイン」→「+その他のアドイン」をクリックします。

![スクリーンショット8](images/install_desktop_08.png)

「共有フォルダー」をクリックすると「st_func」が表示されえているので、選択して「追加」をクリックします。

![スクリーンショット9](images/install_desktop_09.png)

## インストール完了の確認

アドインの読み込みが完了すると、ホームタブに「st_funcについて」というアイコンが表示されます。

カスタム関数が動くかどうかの確認をします。例えばセルに「=STF.secFlatBar("A",100,10)」と入力して、1000が表示されればインストール成功です。

![スクリーンショット10](images/install_desktop_10.png)

## キャッシュのクリア

アドインが更新された場合はアプリのキャッシュをクリアする必要があります。キャッシュをクリアするには、インストール時と同様に「信頼できるアドインカタログ」を開き、「次回Officeを起動するときに、以前に起動したすべてのWebアドインキャッシュをクリアします」にチェックを入れて「OK」をクリックし、Excelを再起動することで、アドインファイルが読み込みなおされます。

![スクリーンショット11](images/install_desktop_cache_clear_01.png)

## アンインストール

インストール時と同様に「信頼できるアドインカタログ」を開き、設定した共有フォルダをクリックして「削除」をクリックし「OK」とすることでアンインストールされます。

![スクリーンショット12](images/install_desktop_uninstall_01.png)